const _0x51e388=_0x568d;(function(_0xc7ee55,_0x26ea06){const _0x508738=_0x568d,_0x12ec56=_0xc7ee55();while(!![]){try{const _0x831575=-parseInt(_0x508738(0x21e))/0x1+-parseInt(_0x508738(0x229))/0x2+parseInt(_0x508738(0x1e4))/0x3*(parseInt(_0x508738(0x22a))/0x4)+parseInt(_0x508738(0x1e8))/0x5*(parseInt(_0x508738(0x236))/0x6)+parseInt(_0x508738(0x233))/0x7*(-parseInt(_0x508738(0x1f9))/0x8)+-parseInt(_0x508738(0x234))/0x9*(parseInt(_0x508738(0x241))/0xa)+parseInt(_0x508738(0x219))/0xb;if(_0x831575===_0x26ea06)break;else _0x12ec56['push'](_0x12ec56['shift']());}catch(_0x3dc484){_0x12ec56['push'](_0x12ec56['shift']());}}}(_0x7dcb,0x243be));const video=document[_0x51e388(0x214)](_0x51e388(0x1e5)),canvas=document[_0x51e388(0x214)](_0x51e388(0x1e7)),captureBtn=document['getElementById']('captureBtn'),recaptureBtn=document[_0x51e388(0x214)](_0x51e388(0x20a)),randomBtn=document[_0x51e388(0x214)](_0x51e388(0x221)),modal=document[_0x51e388(0x214)]('modal'),closeModal=document['querySelector']('.close-modal'),selectedFaceCanvas=document[_0x51e388(0x214)](_0x51e388(0x206)),cameraSelect=document['getElementById'](_0x51e388(0x227)),resolutionSelect=document[_0x51e388(0x223)](_0x51e388(0x1e9));resolutionSelect['id']=_0x51e388(0x23e);const controlsDiv=document['querySelector'](_0x51e388(0x211));function _0x7dcb(){const _0x5233eb=['floor','/models','change','cameraSelect','style','472526ORgpGQ','4052zFTzWt','getContext','value','Camera\x20','#ff0000','forEach','#00ff00','environment','Error\x20accessing\x20camera:','21swCHwk','2521971zyvDMs','lineWidth','1757454hJBpUI','videoinput','clearRect','withFaceLandmarks','random','setAttribute','4K\x20(2160p)','SsdMobilenetv1Options','resolutionSelect','insertBefore','click','10yWjkpj','playsinline','fillText','getSettings','box','471ruREAj','video','text','canvas','5ksMNyc','select','detection','log','height','nets','getTracks','length','target','No\x20faces\x20detected!','Full\x20HD\x20(1080p)','true','loadFromUri','drawImage','ssdMobilenetv1','srcObject','selectedIndex','694576BxVrbJ','Error\x20loading\x20cameras:','split','addEventListener','faceRecognitionNet','detectAllFaces','width','putImageData','round','strokeStyle','option','play','stop','selectedFace','font','appendChild','mediaDevices','recaptureBtn','getVideoTracks','none','then','onloadedmetadata','display','getUserMedia','.controls','label','filter','getElementById','options','innerHTML','faceLandmark68Net','strokeRect','5577594agnulp','offsetWidth','inline-block','max','getCapabilities','33642OeuLvo','error','deviceId','randomBtn','map','createElement'];_0x7dcb=function(){return _0x5233eb;};return _0x7dcb();}controlsDiv[_0x51e388(0x23f)](resolutionSelect,captureBtn);const resolutions=[{'label':_0x51e388(0x23c),'width':0xf00,'height':0x870},{'label':_0x51e388(0x1f2),'width':0x780,'height':0x438},{'label':'HD\x20(720p)','width':0x500,'height':0x2d0},{'label':'VGA\x20(480p)','width':0x280,'height':0x1e0}];let detectedFaces=[],capturedImageData=null,isCaptureModeActive=!![],currentStream=null,currentDeviceId='';Promise['all']([faceapi[_0x51e388(0x1ed)][_0x51e388(0x1f6)][_0x51e388(0x1f4)](_0x51e388(0x225)),faceapi[_0x51e388(0x1ed)][_0x51e388(0x217)][_0x51e388(0x1f4)](_0x51e388(0x225)),faceapi['nets'][_0x51e388(0x1fd)][_0x51e388(0x1f4)](_0x51e388(0x225))])[_0x51e388(0x20d)](initializeApp);async function populateResolutions(){const _0x448831=_0x51e388;resolutionSelect[_0x448831(0x216)]='<option\x20value=\x22\x22>กำลังโหลดความละเอียด...</option>';try{const _0x3edad6=await navigator[_0x448831(0x209)][_0x448831(0x210)]({'video':!![]}),_0x4cd4e6=_0x3edad6[_0x448831(0x20b)]()[0x0],_0x189595=_0x4cd4e6[_0x448831(0x21d)]();_0x3edad6[_0x448831(0x1ee)]()[_0x448831(0x22f)](_0x4344b5=>_0x4344b5[_0x448831(0x205)]()),resolutionSelect[_0x448831(0x216)]='';const _0x2eb658=resolutions[_0x448831(0x213)](_0x42592e=>{const _0x127429=_0x448831;return(!_0x189595['width']||_0x42592e[_0x127429(0x1ff)]<=_0x189595[_0x127429(0x1ff)][_0x127429(0x21c)])&&(!_0x189595[_0x127429(0x1ec)]||_0x42592e[_0x127429(0x1ec)]<=_0x189595['height'][_0x127429(0x21c)]);});_0x2eb658[_0x448831(0x22f)](_0x2b4807=>{const _0x41c0b0=_0x448831,_0x3cd006=document[_0x41c0b0(0x223)](_0x41c0b0(0x203));_0x3cd006[_0x41c0b0(0x22c)]=_0x2b4807[_0x41c0b0(0x1ff)]+'x'+_0x2b4807['height'],_0x3cd006['text']=_0x2b4807[_0x41c0b0(0x212)],resolutionSelect[_0x41c0b0(0x208)](_0x3cd006);}),resolutionSelect[_0x448831(0x215)]['length']>0x0&&(resolutionSelect[_0x448831(0x1f8)]=0x0);}catch(_0x4ad7c7){console['error']('Error\x20getting\x20camera\x20capabilities:',_0x4ad7c7),resolutions[_0x448831(0x22f)](_0x57343b=>{const _0x56fca9=_0x448831,_0x389aae=document[_0x56fca9(0x223)](_0x56fca9(0x203));_0x389aae['value']=_0x57343b['width']+'x'+_0x57343b[_0x56fca9(0x1ec)],_0x389aae[_0x56fca9(0x1e6)]=_0x57343b[_0x56fca9(0x212)],resolutionSelect[_0x56fca9(0x208)](_0x389aae);});}}function _0x568d(_0x27bfa3,_0xf03ace){const _0x7dcb65=_0x7dcb();return _0x568d=function(_0x568de1,_0x3ae1c1){_0x568de1=_0x568de1-0x1e3;let _0x31834d=_0x7dcb65[_0x568de1];return _0x31834d;},_0x568d(_0x27bfa3,_0xf03ace);}async function initializeApp(){const _0x2babf0=_0x51e388;await loadAvailableCameras(),await populateResolutions(),cameraSelect[_0x2babf0(0x215)][_0x2babf0(0x1ef)]>0x0&&startVideo(cameraSelect['value']);}async function loadAvailableCameras(){const _0x31b072=_0x51e388;try{await navigator[_0x31b072(0x209)][_0x31b072(0x210)]({'video':!![]});const _0x5c65b5=await navigator['mediaDevices']['enumerateDevices'](),_0x251601=_0x5c65b5[_0x31b072(0x213)](_0x2d0464=>_0x2d0464['kind']===_0x31b072(0x237));cameraSelect[_0x31b072(0x216)]='',_0x251601[_0x31b072(0x22f)](_0x26836c=>{const _0x135ec2=_0x31b072,_0x17a182=document[_0x135ec2(0x223)](_0x135ec2(0x203));_0x17a182['value']=_0x26836c[_0x135ec2(0x220)],_0x17a182[_0x135ec2(0x1e6)]=_0x26836c['label']||_0x135ec2(0x22d)+(cameraSelect[_0x135ec2(0x215)][_0x135ec2(0x1ef)]+0x1),cameraSelect[_0x135ec2(0x208)](_0x17a182);});}catch(_0x2f9387){console[_0x31b072(0x21f)](_0x31b072(0x1fa),_0x2f9387);}}async function startVideo(_0xd1513=''){const _0x57766f=_0x51e388;currentStream&&currentStream[_0x57766f(0x1ee)]()[_0x57766f(0x22f)](_0x4cb39c=>_0x4cb39c[_0x57766f(0x205)]());currentDeviceId=_0xd1513;const [_0x2fa59c,_0x5d59bd]=resolutionSelect['value'][_0x57766f(0x1fb)]('x')[_0x57766f(0x222)](Number),_0x34bab7={'video':{'deviceId':_0xd1513?{'exact':_0xd1513}:undefined,'width':{'ideal':_0x2fa59c},'height':{'ideal':_0x5d59bd},'facingMode':_0xd1513?undefined:_0x57766f(0x231)}};try{const _0x14c995=await navigator[_0x57766f(0x209)][_0x57766f(0x210)](_0x34bab7);currentStream=_0x14c995,video[_0x57766f(0x1f7)]=_0x14c995,video['setAttribute'](_0x57766f(0x242),'true');const _0x6ede=_0x14c995[_0x57766f(0x20b)]()[0x0],_0x27a221=_0x6ede[_0x57766f(0x244)]();console[_0x57766f(0x1eb)]('Actual\x20camera\x20settings:',_0x27a221),video[_0x57766f(0x20e)]=()=>{const _0x2a9666=_0x57766f;canvas['width']=_0x27a221[_0x2a9666(0x1ff)],canvas[_0x2a9666(0x1ec)]=_0x27a221[_0x2a9666(0x1ec)];},await video[_0x57766f(0x204)]();}catch(_0x1e4bd8){console[_0x57766f(0x21f)](_0x57766f(0x232),_0x1e4bd8);try{const _0x3826c0=await navigator[_0x57766f(0x209)][_0x57766f(0x210)]({'video':_0xd1513?{'deviceId':{'exact':_0xd1513}}:!![]});currentStream=_0x3826c0,video[_0x57766f(0x1f7)]=_0x3826c0,video[_0x57766f(0x23b)](_0x57766f(0x242),_0x57766f(0x1f3)),await video[_0x57766f(0x204)]();}catch(_0x5304e7){console[_0x57766f(0x21f)]('Fallback\x20camera\x20access\x20failed:',_0x5304e7);}}}cameraSelect['addEventListener'](_0x51e388(0x226),_0x309f7d=>{const _0x5e34a2=_0x51e388;isCaptureModeActive&&startVideo(_0x309f7d[_0x5e34a2(0x1f0)][_0x5e34a2(0x22c)]);}),resolutionSelect['addEventListener'](_0x51e388(0x226),()=>{isCaptureModeActive&&startVideo(currentDeviceId);}),captureBtn[_0x51e388(0x1fc)](_0x51e388(0x240),async()=>{const _0x1ebcc1=_0x51e388,_0x3c53f1=canvas[_0x1ebcc1(0x22b)]('2d'),_0x1e1a7a=currentStream[_0x1ebcc1(0x20b)]()[0x0],_0x578099=_0x1e1a7a[_0x1ebcc1(0x244)]();canvas[_0x1ebcc1(0x1ff)]=_0x578099['width'],canvas[_0x1ebcc1(0x1ec)]=_0x578099[_0x1ebcc1(0x1ec)],_0x3c53f1[_0x1ebcc1(0x1f5)](video,0x0,0x0,canvas['width'],canvas[_0x1ebcc1(0x1ec)]),capturedImageData=_0x3c53f1['getImageData'](0x0,0x0,canvas[_0x1ebcc1(0x1ff)],canvas[_0x1ebcc1(0x1ec)]);const _0x4c822a=await faceapi[_0x1ebcc1(0x1fe)](canvas,new faceapi[(_0x1ebcc1(0x23d))]({'minConfidence':0.3}))[_0x1ebcc1(0x239)]();detectedFaces=_0x4c822a,drawDetections(),captureBtn[_0x1ebcc1(0x228)]['display']=_0x1ebcc1(0x20c),recaptureBtn[_0x1ebcc1(0x228)][_0x1ebcc1(0x20f)]=_0x1ebcc1(0x21b),randomBtn['style'][_0x1ebcc1(0x20f)]=_0x1ebcc1(0x21b),isCaptureModeActive=![],currentStream&&currentStream['getTracks']()[_0x1ebcc1(0x22f)](_0x5c1576=>_0x5c1576[_0x1ebcc1(0x205)]());});function drawDetections(){const _0x2c4d5f=_0x51e388;if(!capturedImageData)return;const _0x2d30e6=canvas[_0x2c4d5f(0x22b)]('2d');_0x2d30e6['putImageData'](capturedImageData,0x0,0x0),detectedFaces['forEach']((_0x51de46,_0x4641fb)=>{const _0x12efb7=_0x2c4d5f,_0xd4887d=_0x51de46[_0x12efb7(0x1ea)][_0x12efb7(0x1e3)];_0x2d30e6[_0x12efb7(0x202)]=_0x12efb7(0x230),_0x2d30e6['lineWidth']=0x2,_0x2d30e6[_0x12efb7(0x218)](_0xd4887d['x'],_0xd4887d['y'],_0xd4887d[_0x12efb7(0x1ff)],_0xd4887d[_0x12efb7(0x1ec)]),_0x2d30e6['fillStyle']='#00ff00',_0x2d30e6[_0x12efb7(0x207)]='16px\x20Arial',_0x2d30e6[_0x12efb7(0x243)](_0x4641fb+0x1,_0xd4887d['x'],_0xd4887d['y']-0x5);});}function animateRandomSelection(){return new Promise(_0x1b6ae2=>{let _0x43538b=0x0;const _0x293e4a=0x14,_0xa89d55=setInterval(()=>{const _0x11eb60=_0x568d;if(!capturedImageData){clearInterval(_0xa89d55);return;}const _0x563348=canvas['getContext']('2d');_0x563348['putImageData'](capturedImageData,0x0,0x0);const _0x3c5345=Math[_0x11eb60(0x224)](Math[_0x11eb60(0x23a)]()*detectedFaces[_0x11eb60(0x1ef)]),_0x2d45d0=detectedFaces[_0x3c5345];_0x563348[_0x11eb60(0x202)]=_0x11eb60(0x22e),_0x563348[_0x11eb60(0x235)]=0xa,_0x563348[_0x11eb60(0x218)](_0x2d45d0['detection']['box']['x'],_0x2d45d0['detection']['box']['y'],_0x2d45d0[_0x11eb60(0x1ea)][_0x11eb60(0x1e3)][_0x11eb60(0x1ff)],_0x2d45d0[_0x11eb60(0x1ea)]['box'][_0x11eb60(0x1ec)]),_0x43538b++,_0x43538b>=_0x293e4a&&(clearInterval(_0xa89d55),_0x1b6ae2(_0x3c5345));},0xfa);});}randomBtn[_0x51e388(0x1fc)](_0x51e388(0x240),async()=>{const _0x309cd4=_0x51e388;if(detectedFaces[_0x309cd4(0x1ef)]===0x0){alert(_0x309cd4(0x1f1));return;}const _0x42b0a7=await animateRandomSelection(),_0xc25b4a=detectedFaces[_0x42b0a7],_0x1ea43c=_0xc25b4a[_0x309cd4(0x1ea)][_0x309cd4(0x1e3)],_0x385257=_0x1ea43c[_0x309cd4(0x1ff)]/_0x1ea43c[_0x309cd4(0x1ec)],_0x58cc2e=0x190,_0xaeb32=Math[_0x309cd4(0x201)](_0x58cc2e/_0x385257);selectedFaceCanvas[_0x309cd4(0x1ff)]=_0x58cc2e,selectedFaceCanvas[_0x309cd4(0x1ec)]=_0xaeb32;const _0x2741d6=selectedFaceCanvas['getContext']('2d'),_0x56f4a8=document[_0x309cd4(0x223)]('canvas');_0x56f4a8[_0x309cd4(0x1ff)]=canvas[_0x309cd4(0x1ff)],_0x56f4a8[_0x309cd4(0x1ec)]=canvas[_0x309cd4(0x1ec)];const _0x3805bf=_0x56f4a8[_0x309cd4(0x22b)]('2d');_0x3805bf[_0x309cd4(0x200)](capturedImageData,0x0,0x0),_0x2741d6[_0x309cd4(0x1f5)](_0x56f4a8,_0x1ea43c['x'],_0x1ea43c['y'],_0x1ea43c[_0x309cd4(0x1ff)],_0x1ea43c[_0x309cd4(0x1ec)],0x0,0x0,_0x58cc2e,_0xaeb32),modal[_0x309cd4(0x228)]['display']='flex',drawDetections();}),recaptureBtn['addEventListener']('click',()=>{const _0x55bc1a=_0x51e388,_0x194beb=canvas[_0x55bc1a(0x22b)]('2d');_0x194beb[_0x55bc1a(0x238)](0x0,0x0,canvas[_0x55bc1a(0x1ff)],canvas['height']),startVideo(cameraSelect[_0x55bc1a(0x22c)]),captureBtn[_0x55bc1a(0x228)]['display']=_0x55bc1a(0x21b),recaptureBtn[_0x55bc1a(0x228)][_0x55bc1a(0x20f)]=_0x55bc1a(0x20c),randomBtn['style'][_0x55bc1a(0x20f)]=_0x55bc1a(0x20c),isCaptureModeActive=!![],detectedFaces=[],capturedImageData=null;}),closeModal[_0x51e388(0x1fc)](_0x51e388(0x240),()=>{const _0x295f1a=_0x51e388;modal[_0x295f1a(0x228)][_0x295f1a(0x20f)]=_0x295f1a(0x20c),drawDetections();}),window[_0x51e388(0x1fc)]('click',_0x53ebbe=>{const _0x5b5286=_0x51e388;_0x53ebbe[_0x5b5286(0x1f0)]===modal&&(modal['style']['display']='none',drawDetections());}),window[_0x51e388(0x1fc)]('resize',()=>{const _0x252424=_0x51e388;if(video&&capturedImageData){const _0x509b51=capturedImageData[_0x252424(0x1ff)]/capturedImageData[_0x252424(0x1ec)],_0x3d1e3e=video[_0x252424(0x21a)],_0x11404e=_0x3d1e3e/_0x509b51;canvas[_0x252424(0x228)][_0x252424(0x1ff)]=_0x3d1e3e+'px',canvas[_0x252424(0x228)][_0x252424(0x1ec)]=_0x11404e+'px',drawDetections();}});